<?php
/*
 * @author Anakeen
 * @package FDL
*/

ini_set("pcre.jit", 0); // Need for PHP7.0 to compress big css files
require_once 'WHAT/Lib.Common.php';

$sty_desc = array(
    "name" => "A4", //Name
    "description" => "A4 STYLE", //long description
);

$generateGlobalScssVarFile = function ()
{
    $globalVarFile = "STYLE/custom-scss-variable.d/global_variables.scss";
    $fullContent = "";
    $files = array();

    $iterator = new DirectoryIterator("STYLE/custom-scss-variable.d/");
    foreach ($iterator as $fileinfo) {
        if (!$fileinfo->isFile()) {
            continue;
        }
        if ($fileinfo->getBasename() == 'global_variables.scss') {
            continue;
        }
        if ($fileinfo->getExtension() === "scss") {
            $files[$fileinfo->getPathname() ] = $fileinfo->getPathname();
        }
    }

    ksort($files);

    foreach ($files as $currentFiles) {
        $fullContent.= "// $currentFiles\n";
        $fullContent.= file_get_contents($currentFiles) . "\n";
    }
    if ((file_exists($globalVarFile) === false) || (($previousContent = file_get_contents($globalVarFile)) === false)) {
        $previousContent = '';
    }
    if ($fullContent !== $previousContent) {
        file_put_contents($globalVarFile, $fullContent);
    }
};

$generateGlobalScssVarFile();
// global parameters which can be use for other css
$sty_rules = array(
    'css' => array(
        'a4/document/bootstrap.css' => array(
            "src" => "STYLE/DDUI/dduiAssets/scss/bootstrap.scss" ,
            "deploy_parser" => array(
                "className" => '\Dcp\Style\A4ScssParser'
            )
        ) ,
        'a4/document/kendo.css' => array(
            "src" => "STYLE/DDUI/dduiAssets/scss/corporate/kendo.bootstrap.scss",
            "deploy_parser" => array(
                "className" => '\Dcp\Style\A4ScssParser'
            ) ,
        ) ,
        'a4/document/document.css' => array(
            "src" => "STYLE/DDUI/dduiAssets/scss/document.scss",
            "deploy_parser" => array(
                "className" => '\Dcp\Style\A4ScssParser'
            )
        ) ,
        'a4/document/ckeditor.css' => array(
            "src" => "public/uiAssets/anakeen/IHM/widgets/attributes/htmltext/ckeditor.scss",
            "deploy_parser" => array(
                "className" => '\Dcp\Style\A4ScssParser'
            )
        ) ,
        'a4/document/login.css' => array(
            "src" => "STYLE/login-page.scss",
            "deploy_parser" => array(
                "className" => '\Dcp\Style\A4ScssParser'
            )
        )
    )
);