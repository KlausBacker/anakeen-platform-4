{
    "id": "http://www.anakeen.com/entry-schema#",
    "$schema": "http://json-schema.org/draft-06/schema#",
    "description": "schema for routes configuration",
    "type": "object",
    "additionalProperties": false,
    "properties": {
        "routes": {
            "type": "object",
            "patternProperties": {
                "^([A-Za-z:0-9-]+)$": {
                    "$ref": "#/definitions/route"
                }
            },
            "additionalProperties": false
        },
        "middlewares": {
            "type": "object",
            "patternProperties": {
                "^([A-Za-z:]+)$": {
                    "$ref": "#/definitions/middleware"
                }
            }
        },
        "accesses": {
            "type": "object",
            "patternProperties": {
                "^([A-Za-z:]+)$": {
                    "$ref": "#/definitions/access"
                }
            },
            "additionalProperties": false
        },
        "apps": {
            "type": "object",
            "patternProperties": {
                "^([A-Z_]+)$": {
                    "$ref": "#/definitions/app"
                }
            },
            "additionalProperties": false
        }
    },
    "definitions": {
        "middleware": {
            "type": "object",
            "properties": {
                "priority": {
                    "description": "Order used in case of multiple matches. The bigger win.",
                    "type": "integer"
                },
                "pattern": {
                    "description": "The uri pattern to route access",
                    "oneOf": [
                        {
                            "type": "array",
                            "minItems": 1,
                            "items": {
                                "type": "string"
                            }
                        },
                        {
                            "type": "string"
                        }
                    ]
                },
                "description": {
                    "type": "string"
                },
                "callable": {
                    "description": "The PHP method to invoke to perform the request",
                    "type": "string"
                },
                "methods": {
                    "type": "array",
                    "description": "HTTP Method needed to perform request",
                    "minItems": 1,
                    "items": {
                        "enum": [
                            "GET",
                            "POST",
                            "PUT",
                            "DELETE",
                            "OPTIONS",
                            "PATCH",
                            "ANY"
                        ]
                    },
                    "uniqueItems": true
                },
                "requiredAccesses": {
                    "type": "array",
                    "description": "Access right to verify before grant the access",
                    "items": {
                        "type": "string"
                    },
                    "uniqueItems": true
                }
            },
            "required": [
                "priority",
                "pattern",
                "methods",
                "callable"
            ],
            "additionalProperties": false
        },
        "route": {
            "type": "object",
            "allOf": [
                {
                    "$ref": "#/definitions/middleware"
                }
            ],
            "properties": {
                "authenticated": {
                    "description": "Is the route need authentication (default is true)",
                    "type": "boolean"
                }
            },
            "additionalProperties": false
        },
        "access": {
            "type": "object",
            "properties": {
                "category": {
                    "description": "Category to classify the access",
                    "type": "string"
                },
                "description": {
                    "description": "Access textual description",
                    "type": "string"
                }
            },
            "required": [
                "category",
                "description"
            ],
            "additionalProperties": false
        },
        "app": {
            "type": "object",
            "properties": {
                "shortName": {
                    "description": "Short description",
                    "type": "string"
                },
                "description": {
                    "description": "App textual description",
                    "type": "string"
                },
                "version": {
                    "description": "App version",
                    "type": "string"
                },
                "icon": {
                    "description": "App icon file",
                    "type": "string"
                },
                "displayable": {
                    "description": "App is displayable",
                    "type": "boolean"
                },
                "parentName": {
                    "description": "Parent App (inherit)",
                    "type": "string"
                },
                "parameters": {
                    "description": "App parameters",
                    "type": "object",
                    "patternProperties": {
                        "^([A-Z_]+)$": {
                            "$ref": "#/definitions/parameter"
                        }
                    },
                    "additionalProperties": false
                }
            },
            "required": [
                "shortName",
                "version"
            ],
            "additionalProperties": false
        },
        "parameter": {
            "type": "object",
            "properties": {
                "value": {
                    "description": "Default value",
                    "oneOf": [
                        {
                            "type": "number"
                        },
                        {
                            "type": "string"
                        }
                    ]
                },
                "description": {
                    "description": "Access textual description",
                    "type": "string"
                },
                "category": {
                    "description": "Access categorisation",
                    "type": "string"
                },
                "isUser": {
                    "description": "Is a user parameter ?",
                    "type": "boolean"
                },
                "type": {
                    "description": "Parameter type",
                    "type": "string"
                },
                "access": {
                    "description": "Admin access",
                    "enum": [
                        "readonly",
                        "admin",
                        "static"
                    ]
                },
                "global": {
                    "description": "Is a global parameter ?",
                    "type": "boolean"
                }
            },
            "required": [
                "value",
                "description"
            ],
            "additionalProperties": false
        }
    }
}