<?xml version="1.0" ?>
<module xmlns="urn:dynacase:webinst:module/1.0"
        license="http://www.gnu.org/licenses/lgpl-3.0.txt GNU Lesser General Public License v3.0"
        name="@moduleName@" release="@release@" version="@version@">
    <description>Admin Center</description>


    <replaces>
        <module name="dynacase-admin-fusers-ui"/>
        <module name="dynacase-admin-access-ui"/>
        <module name="dynacase-admin-appmng-ui" />
        <module name="dynacase-admin-docadmin-ui"/>
        <module name="dynacase-admin-httpapi-v1"/>
        <module name="dynacase-admin-authent-ui"/>
        <module name="dynacase-admin-uis"/>
        <module name="dynacase-admin"/>
        <module name="anakeen-admin"/>
    </replaces>

    <requires>
        <!-- To remove after refactor -->
        <module name="legacy"/>
        <module name="anakeen-ui"/>
    </requires>

    <pre-install>
        <check type="phpclass" class="ZipArchive">
            <help>You might need to install a php-zip package from your distribution in order to have ZipArchive support
                in PHP.
            </help>
        </check>
    </pre-install>
    <post-install>

        <process command="programs/record_application CORE_ADMIN"/>

        <process command="programs/record_application FUSERS I">
            <label>Record FUSERS application in database</label>
        </process>

        <process
                command="./wsh.php --api=importDocuments --file=./Apps/CORE_ADMIN/Data/Init.csv">
            <label>Initializing CORE_ADMIN roles and ACLs</label>
        </process>
        <process
                command="./wsh.php --api=importDocuments --file=./Apps/FUSERS/Data/Init.csv">
            <label>Initializing FUSERS roles and ACLs</label>
        </process>
        <process command="programs/record_application APPMNG I">
            <label>Record appmng application in database</label>
        </process>
        <process
                command="./wsh.php --api=importDocuments --file=./Apps/APPMNG/Data/Init.csv">
            <label>Initializing APPMNG roles and ACLs</label>
        </process>

        <process command="programs/record_application VAULT I">
            <label>Record vault application in database</label>
        </process>
        <process
                command="./wsh.php --api=importDocuments --file=./Apps/VAULT/Data/Init.csv">
            <label>Initializing VAULT roles and ACLs</label>
        </process>

        <process command="programs/record_application ACCESS I">
            <label>Record access application in database</label>
        </process>
        <process
                command="./wsh.php --api=importDocuments --file=./Apps/ACCESS/Data/Init.csv">
            <label>Initializing ACCESS roles and ACLs</label>
        </process>


        <process command="programs/record_application DOCADMIN I">
            <label>Record access application in database</label>
        </process>
        <process
                command="./wsh.php --api=importDocuments --file=./Apps/DOCADMIN/Data/Init.csv">
            <label>Initializing DOCADMIN roles and ACLs</label>
        </process>
        <process
                command="./wsh.php --api=importDocuments --file=./Apps/DOCADMIN/Data/Update.csv">
            <label>Init DOCADMIN searches</label>
        </process>

        <process command="programs/record_application AUTHENTUI I"/>
        <process command="programs/record_application HTTPAPI_V1_ADMIN I"/>
        <process command="programs/update_catalog"/>
    </post-install>
    <post-upgrade>
        <process command="programs/pre_migration CORE_ADMIN"/>
        <process command="programs/record_application CORE_ADMIN"/>
        <process command="programs/post_migration CORE_ADMIN"/>


        <process command="programs/pre_migration FUSERS"/>
        <process command="programs/record_application FUSERS U">
            <label>Update FUSERS application</label>
        </process>
        <process command="programs/post_migration FUSERS"/>


        <process command="programs/pre_migration ACCESS"/>
        <process command="programs/record_application ACCESS U">
            <label>Update access application in database</label>
        </process>
        <process command="programs/post_migration ACCESS"/>

        <process command="programs/pre_migration APPMNG"/>
        <process command="programs/record_application APPMNG U">
            <label>Update appmng application in database</label>
        </process>
        <process command="programs/post_migration APPMNG"/>

        <process command="programs/pre_migration DOCADMIN"/>
        <process command="programs/record_application DOCADMIN U">
            <label>Update DOCADMIN application in database</label>
        </process>
        <process command="programs/post_migration DOCADMIN"/>
        <process
                command="./wsh.php --api=importDocuments --file=./Apps/DOCADMIN/Data/Update.csv">
            <label>Update DOCADMIN searches</label>
        </process>

        <process command="programs/pre_migration VAULT" />
        <process command="programs/record_application VAULT U">
            <label>Update VAULT application in database</label>
        </process>
        <process command="programs/post_migration VAULT" />
        <process command="programs/record_application AUTHENTUI U"/>
        <process command="programs/record_application HTTPAPI_V1_ADMIN U"/>
        <process command="programs/update_catalog"/>
    </post-upgrade>
</module>
