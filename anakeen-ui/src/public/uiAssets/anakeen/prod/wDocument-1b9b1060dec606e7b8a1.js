/*! v1.0.0-1098-g48daa27 */
webpackJsonp(["wDocument"],{a2b1083ba5d095ec0632:function(e,t,n){"use strict";var i,r,a;!function(o,s){r=[n('external "jQuery"'),n("8e08e542008e4aef1f58"),n("f562ab9f022eef93542c")],void 0===(a="function"==typeof(i=s)?i.apply(t,r):i)||(e.exports=a)}(window,function(e,t){var n=["beforeRender","ready","change","displayMessage","displayError","validate","attributeBeforeRender","attributeReady","attributeHelperSearch","attributeHelperResponse","attributeHelperSelect","attributeArrayChange","actionClick","attributeAnchorClick","beforeClose","close","beforeSave","afterSave","attributeDownloadFile","attributeUploadFile","attributeUploadFileDone","beforeDelete","afterDelete","beforeRestore","afterRestore","failTransition","successTransition","beforeDisplayTransition","afterDisplayTransition","beforeTransition","beforeTransitionClose","destroy","attributeCreateDialogDocumentBeforeSetFormValues","attributeCreateDialogDocumentBeforeSetTargetValue","attributeCreateDialogDocumentReady","attributeCreateDialogDocumentBeforeClose","attributeCreateDialogDocumentBeforeDestroy"],i=function(e){this.name="WidgetDocumentNotLoaded",this.message=e||"The document widget is not loaded, wait for the documentloaded event"};(i.prototype=Object.create(Error.prototype)).constructor=i,e.widget("dcp.document",{_template:t.template('<iframe class="dcpDocumentWrapper" name="<%- options.iframeName %>" style="border : 0;" data-src="api/v1/documents/0.html#widgetValue<%- options.json_encode %>"></iframe>'),defaults:{resizeMarginHeight:3,resizeMarginWidth:0,resizeDebounceTime:50,withoutResize:!1,iframeName:t.uniqueId("documentFrame"),noRouter:!0,eventPrefix:"document"},_create:function(){this.options=t.extend({},this.defaults,this.options),this.options.eventListener={},this.options.constraintList={},this.options.cssToInject=[],this.options.jsToInject=[],this._render(),this._bindEvents()},_render:function(){var n,i,r,a=this;r=JSON.stringify(t.omit(this.options,"resizeMarginHeight","resizeMarginWidth","resizeDebounceTime","withoutResize","iframeName","eventPrefix","eventListener","constraintList")),this.element.empty().append(this._template({options:{iframeName:this.options.iframeName,json_encode:r}})),(n=this.element.find(".dcpDocumentWrapper")).length>0&&((i=n[0].contentWindow).location.href=n.data("src"),n.on("load",function(){i.documentLoaded=function(e,t){a._bindInternalWidget.call(a,e.data("dcpDocumentController"),t),a.element.data("voidLoaded",!t||!t.initid)},e(i).on("unload",function(){a._unbindInternalWidget.call(a)}),i.dcp&&i.dcp.triggerReload&&!1===i.dcp.documentReady&&i.dcp.triggerReload()})),this._resize()},_unbindInternalWidget:function(){this.element.data("internalWidgetInitialised",!1),this.element.data("internalWidget",!1),this._trigger("internalWidgetUnloaded"),this._trigger("unloaded")},rebindEvents:function(){var e=this.element.data("internalWidget");e&&(t.each(this.options.eventListener,function(t){e.addEventListener(t)}),t.each(this.options.constraintList,function(t){e.addConstraint(t)}))},reinjectCSSAndJS:function(){var e=this.element.data("internalWidget");if(e)try{e.injectCSS(this.options.cssToInject),e.injectJS(this.options.jsToInject)}catch(e){}},_bindInternalWidget:function(e,t){return this.element.data("internalWidget",e),t||(this.rebindEvents(),this.reinjectCSSAndJS()),this.element.data("internalWidgetInitialised",!0),t?(this._trigger("loaded",{},{isEmpty:!0}),this):(this._trigger("loaded"),this)},_bindEvents:function(){this.options.withoutResize||(e(window).on("resize"+this.eventNamespace,t.debounce(t.bind(this._resize,this),parseInt(this.options.resizeDebounceTime,10))),this._resize())},_resize:function(){var e=this._trigger("autoresize"),n=this.element.find(".dcpDocumentWrapper"),i=this,r=this.element;!this.options.withoutResize&&e&&(n.height(r.innerHeight()-parseInt(i.options.resizeMarginHeight,10)),n.width(r.innerWidth()-parseInt(i.options.resizeMarginWidth,10)),t.defer(function(){n.height(r.innerHeight()-parseInt(i.options.resizeMarginHeight,10))}))},tryToDestroy:function(){var e=this;return new Promise(function(t,n){e.isLoaded()?e.element.data("internalWidget").tryToDestroy().then(function(){t(),e._destroy()}).catch(function(e){n(e)}):(t(),e._destroy())})},_destroy:function(){e(window).off(this.eventNamespace),this.element.empty(),this._unbindInternalWidget(),this._trigger("destroy"),this._super()},_checkEventName:function(e){if(t.isString(e)&&(0===e.indexOf("custom:")||t.find(n,function(t){return t===e})))return!0;throw new Error("The event type "+e+" is not known. It must be one of "+n.join(" ,"))},options:function(){throw new Error("You cannot modify the options, you need to suppress the widget")},fetchDocument:function(e,n){var i,r=this,a=null,o=function(){r.rebindEvents.call(r),r.element.data("voidLoaded",!1)};if(n=n||{},!e.initid)throw new Error("You need to set the initid to fetch the document");if(t.each(t.pick(e,"initid","revision","viewId","customClientData"),function(e,t){r.options[t]=e}),this.element.data("internalWidgetInitialised"))return i=this.element.data("internalWidget"),n.success&&(n.success=t.wrap(n.success,function(e){return o.apply(this,t.rest(arguments)),e.apply(this,t.rest(arguments))})),n.error&&(n.error=t.wrap(n.error,function(e){return o.apply(this,t.rest(arguments)),e.apply(this,t.rest(arguments))})),a=i.fetchDocument.call(i,e,n),n.success||a.then(o),n.error||a.catch(o),a;this._render()},addEventListener:function(e,n,i){var r,a=this;if(t.isUndefined(i)&&t.isFunction(n)&&(i=n,n={}),t.isObject(e)&&t.isUndefined(n)&&t.isUndefined(i)){if(!(r=e).name)throw new Error("When an event is initiated with a single object, this object needs to have the name property ".JSON.stringify(r))}else r=t.defaults(n,{name:t.uniqueId("event_"+e),eventType:e,eventCallback:i,externalEvent:!0,once:!1});return this._checkEventName(r.eventType),!0===r.once&&(r.eventCallback=t.wrap(r.eventCallback,function(e){try{e.apply(this,t.rest(arguments))}catch(e){console.error(e)}a.removeEventListener(r.name)})),r.once=!1,this.options.eventListener[r.name]=r,this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")&&this.element.data("internalWidget").addEventListener(r),r.name},listEventListeners:function(){return this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")?this.element.data("internalWidget").listEventListeners():this.options.eventListener},removeEventListener:function(e){var n,i,r=[],a=new RegExp("\\"+e+"$");return n=t.filter(this.options.eventListener,function(t){return t.name!==e&&!a.test(t.name)||(r.push(t),!1)}),i={},t.each(n,function(e){i[e.name]=e}),this.options.eventListener=i,this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")&&this.element.data("internalWidget").removeEventListener(e,!0),r},addConstraint:function(e,n){var i,r=this;if(t.isUndefined(n)&&t.isFunction(e)&&(n=e,e={}),t.isObject(e)&&t.isUndefined(n)){if(!e.name)throw new Error("When a constraint is initiated with a single object, this object needs to have the name property ".JSON.stringify(e))}else i=t.defaults(e,{documentCheck:function(){return!0},attributeCheck:function(){return!0},constraintCheck:n,name:t.uniqueId("constraint"),externalConstraint:!1,once:!1});if(!t.isFunction(i.constraintCheck))throw new Error("An event need a callback");return!0===i.once&&(i.eventCallback=t.wrap(i.constraintCheck,function(e){try{e.apply(this,t.rest(arguments))}catch(e){console.error(e)}r.removeConstraint(i.name,i.externalConstraint)})),this.options.constraintList[i.name]=i,this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")&&this.element.data("internalWidget").addConstraint(i),i.name},listConstraints:function(){return this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")?this.element.data("internalWidget").listConstraints():this.options.constraintList},removeConstraint:function(e){var n,i,r=[],a=new RegExp("\\"+e+"$");return n=t.filter(this.options.constraintList,function(t){return t.name!==e&&!a.test(t.name)||(r.push(t),!1)}),i={},t.each(n,function(e){i[e.name]=e}),this.options.constraintList=i,this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")&&this.element.data("internalWidget").removeConstraint(e,!0),r},isLoaded:function(){return this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")},injectCSS:function(e){if(!t.isArray(e)&&!t.isString(e))throw new Error("The css to inject must be an array string or a string");t.isString(e)&&(e=[e]),this.options.cssToInject=t.union(this.options.cssToInject,e),this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")&&this.element.data("internalWidget").injectCSS(e)},injectJS:function(e){if(!t.isArray(e)&&!t.isString(e))throw new Error("The js to inject must be an array string or a string");t.isString(e)&&(e=[e]),this.options.jsToInject=t.union(this.options.jsToInject,e),this.element.data("internalWidgetInitialised")&&!this.element.data("voidLoaded")&&this.element.data("internalWidget").injectJS(e)}}),e.fn.document=t.wrap(e.fn.document,function(e,n){var r;try{return e.apply(this,t.rest(arguments))}catch(e){if("noSuchMethodError"===e.name){if("string"==typeof n&&!this.data("internalWidgetInitialised"))throw new i;if(r=this.data("internalWidget"),t.isFunction(r[n])&&"_"!==n.charAt(0))return r[n].apply(r,t.rest(arguments,2))}throw e}})})}});
//# sourceMappingURL=wDocument-1b9b1060dec606e7b8a1.js.map